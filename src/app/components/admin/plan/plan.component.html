<app-navbar></app-navbar>
<div class="container mb-10">
  <div fxLayout="row" fxLayoutAlign="space-between center" *ngIf="screen==false">
    <div fxFlex="30%">
      <mat-card class="pb-0 example-card mat-elevation-z8 formClassPro">
        <form [formGroup]="userForm" fxFlex fxLayout="column" autocomplete="off">
          <mat-form-field>
            <mat-select placeholder="Projects" id="selectProject" [(ngModel)]="selectedProjectName"
              formControlName="proType" multiple>
              <mat-option #allProSelected (click)="toggleAllProSelection()" [value]="0">All</mat-option>
              <mat-option *ngFor="let pro of pros" [value]="pro.proid" (click)="selectproid(this.pro)"
                matTooltip="{{pro.value}}" matTooltipPosition="right">
                {{pro.value}}
              </mat-option>
              <div></div>
            </mat-select>
          </mat-form-field>
        </form>
      </mat-card>
    </div>
    <mat-card class="pb-0 example-card mat-elevation-z8 formClassDate">
      <mat-form-field>
        <input matInput [matDatepicker]="startPicker" [(ngModel)]="plan.startDate" placeholder="Project start date"
          [min]="startMinDate" [max]="startMaxDate" (focus)="startPicker.open()" name="start_Date" class="form-control"
          (click)="startPicker.open()" (dateChange)="changedStartDate('change', $event)" readonly>
        <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
        <mat-datepicker #startPicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field>
        <input matInput [matDatepicker]="endPicker" placeholder="Project end date" (focus)="endPicker.open()"
          [min]="endMinDate" [max]="endMaxDate" name="end_Date" class="form-control" [(ngModel)]="plan.endDate"
          (click)="endPicker.open()" (dateChange)="changedEndDate('change', $event)" readonly>
        <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
        <mat-datepicker #endPicker></mat-datepicker>
      </mat-form-field>
      <button mat-raised-button class="actionButton1" (click)="changedDate()">View Plan</button>
    </mat-card>
    <div>
      <a color="primary" class="actionButton" mat-fab routerLink="timesheet/admin/planning/add" (click)="addPlan()"
        routerLinkActive="active">
        <mat-icon aria-label="Example icon-button with a heart icon">add</mat-icon>
      </a>
    </div>
  </div>
  <div fxLayout="column" fxLayoutAlign="space-evenly center " *ngIf="screen==true">
    <form [formGroup]="userForm" autocomplete="off" style="width: -webkit-fill-available;">
      <div fxLayout="column" fxLayoutAlign="space-around">
        <div fxLayout="row" fxLayoutAlign="space-between" style="display: none;">
          <mat-list-item class="primary-imenu-item" role="listitem" style="display: none;">
            <mat-form-field class="small-width">
              <mat-select placeholder="Users" multiple [(ngModel)]="selectedUserName" formControlName="userType"
                id="selectUser">
                <mat-option #allUserSelected (click)="toggleAllUserSelection()" [value]="0">All</mat-option>
                <mat-option *ngFor="let user of users" [value]="user.userid" (click)="selectuserid(this.user)">
                  {{user.value}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </mat-list-item>
          <div>
            <a color="primary" class="actionButton" mat-mini-fab routerLink="timesheet/admin/planning/add"
              style="display: none;" (click)="addPlan()" routerLinkActive="active">
              <mat-icon aria-label="Example icon-button with a heart icon">add</mat-icon>
            </a>
          </div>
        </div>
        <div fxLayout="row" fxLayoutAlign="space-between" style="display: none;">
          <mat-form-field class="small-width">
            <mat-select placeholder="Projects" id="selectProject" [(ngModel)]="selectedProjectName"
              formControlName="proType" multiple>
              <mat-option #allProSelected (click)="toggleAllProSelection()" [value]="0">All</mat-option>
              <mat-option *ngFor="let pro of pros" [value]="pro.proid" (click)="selectproid(this.pro)"
                matTooltip="{{pro.value}}" matTooltipPosition="right">
                {{pro.value}}
              </mat-option>
              <div></div>
            </mat-select>
          </mat-form-field>
          <div>
            <a color="primary" class="actionButton" mat-mini-fab routerLink="timesheet/admin/planning/add"
              (click)="addPlan()" routerLinkActive="active">
              <mat-icon aria-label="Example icon-button with a heart icon">add</mat-icon>
            </a>
          </div>
        </div>
      </div>
    </form>
    <div class="dateDiv" fxLayout="column" fxLayoutAlign="space-evenly">
      <div>
        <mat-form-field class="small-width">
          <input matInput [matDatepicker]="startPicker" [(ngModel)]="startDate" placeholder="Project start date"
            [min]="startMinDate" [max]="startMaxDate" (focus)="startPicker.open()" name="start_Date"
            class="form-control" (click)="startPicker.open()" (dateChange)="changedStartDate('change', $event)"
            readonly>
          <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
          <mat-datepicker #startPicker></mat-datepicker>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field class="small-width">
          <input matInput [matDatepicker]="endPicker" placeholder="Project end date" (focus)="endPicker.open()"
            [min]="endMinDate" [max]="endMaxDate" name="end_Date" class="form-control" [(ngModel)]="endDate"
            (click)="endPicker.open()" (dateChange)="changedEndDate('change', $event)" readonly>
          <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
          <mat-datepicker #endPicker></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="datebtnDiv">
        <button mat-raised-button class="actionButton1" (click)="changedDate()">View Plan</button>
      </div>
    </div>
  </div>

</div>
<div class="container">
  <div *ngIf="showTable==false" class="mat-elevation-z8 project-table msgTable">
    <mat-card class="error-msg text-center">{{tableMsg}}</mat-card>
  </div>
  <div *ngIf="showTable" class="mat-elevation-z8 example-container" [class.isMobile]="isMobile">
    <table mat-table [dataSource]="dataSource" matSort>
      <ng-container matColumnDef="empName" sticky>
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Employee Name</th>
        <td mat-cell *matCellDef="let element">
          <span class="mobile-label">Employee:</span>
          {{element.empName}}</td>
      </ng-container>
      <ng-container matColumnDef="projectName" sticky>
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Project</th>
        <td mat-cell *matCellDef="let element">
          <span class="mobile-label">Project Name:</span>
          {{element.projectName}}</td>
      </ng-container>
      <ng-container matColumnDef="showAvAs" sticky>
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <span class="mobile-label"></span>
          <pre>Available
Assigned 
                    </pre>
        </td>
      </ng-container>
      <ng-container *ngFor="let column of columns" matColumnDef="{{column.columnDef}}">
        <th mat-header-cell *matHeaderCellDef matTooltip="{{column.hoverTxt }}"
          class="mat-header-cell {{column.class}}">
          {{column.header }}
        </th>
        <td mat-cell *matCellDef="let element" class='dataEle {{column.class}}'>
          <span class="mobile-label">{{column.header }}:</span>
          <pre> {{element[''+column.columnDef].Available}}
<input matInput class="assignedInput" placeholder="Hours" type='number'
                 [ngModel]="element[''+column.columnDef].Assigned" readonly>
                    </pre>
        </td>
      </ng-container>
      <ng-container matColumnDef="total" stickyEnd>
        <th mat-header-cell *matHeaderCellDef>Total</th>
        <td mat-cell *matCellDef="let element">
          <span class="mobile-label">Total : </span>
          <pre> {{element.totalAss}}
<input matInput class="assignedInput"  type='number' [ngModel]="element.total" readonly>
              </pre>
        </td>
      </ng-container>
      <ng-container matColumnDef="action" stickyEnd>
        <th mat-header-cell *matHeaderCellDef class="actionsHead"> Action</th>
        <td mat-cell *matCellDef="let element" class="actions">
          <button mat-button (click)="editPlan(element)" [disabled]="planSubmit ? true : false">
            <em class="material-icons ">
              edit
            </em>
          </button>
        </td>
      </ng-container>
      <ng-container *ngFor="let column of tempTopCol" matColumnDef="{{column.columnDef}}">
        <th mat-header-cell *matHeaderCellDef class="mat-header-cell weekData tempData {{column.class}}"
          [attr.colspan]="column.colspan" [attr.rowspan]="column.rowspan">
          {{column.header}}
        </th>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedTopColumns; sticky: true" class="TopHeadersTr"></tr>
      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" class="secondary-header"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <div class="footer">
      <mat-paginator #paginator [pageIndex]="0" [pageSize]="10" [pageSizeOptions]="[5, 10, 50, 100]"
        showFirstLastButtons>
      </mat-paginator>
    </div>
  </div>
</div>